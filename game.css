<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const playerSize = 20;
const ballSize = 10;

const ball = { x: canvas.width/2, y: canvas.height/2, vx: 0, vy: 0 };

const teamA = [];
const teamB = [];

for (let i=0; i<11; i++) {
  teamA.push({ x: 120, y: 40 + i*35, color: "blue" });
  teamB.push({ x: 680, y: 40 + i*35, color: "red" });
}

const keeperA = { x: 60, y: canvas.height/2, color: "yellow" };
const keeperB = { x: 740, y: canvas.height/2, color: "yellow" };

const keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

function movePlayers() {
  const p = teamA[0]; // নীল টিমের প্রথম প্লেয়ার
  if (keys["ArrowUp"]) p.y -= 3;
  if (keys["ArrowDown"]) p.y += 3;
  if (keys["ArrowLeft"]) p.x -= 3;
  if (keys["ArrowRight"]) p.x += 3;

  // প্লেয়ার আর বলের ধাক্কা
  let dx = ball.x - p.x;
  let dy = ball.y - p.y;
  let dist = Math.sqrt(dx*dx + dy*dy);

  if (dist < playerSize/2 + ballSize) {
    // প্লেয়ার ধাক্কা দিলে বলের ভেলোসিটি সেট
    ball.vx = dx * 0.2;
    ball.vy = dy * 0.2;
  }
}

function moveBall() {
  ball.x += ball.vx;
  ball.y += ball.vy;

  // ঘর্ষণ (speed ধীরে কমবে)
  ball.vx *= 0.98;
  ball.vy *= 0.98;

  // দেয়ালে ধাক্কা
  if (ball.x < ballSize || ball.x > canvas.width - ballSize) {
    ball.vx *= -1;
  }
  if (ball.y < ballSize || ball.y > canvas.height - ballSize) {
    ball.vy *= -1;
  }
}

function drawField() {
  ctx.fillStyle = "darkgreen";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.strokeStyle = "white";
  ctx.lineWidth = 2;
  ctx.strokeRect(50, 50, canvas.width-100, canvas.height-100);

  ctx.beginPath();
  ctx.moveTo(canvas.width/2, 50);
  ctx.lineTo(canvas.width/2, canvas.height-50);
  ctx.stroke();

  ctx.beginPath();
  ctx.arc(canvas.width/2, canvas.height/2, 50, 0, Math.PI*2);
  ctx.stroke();
}

function drawPlayers() {
  [...teamA, ...teamB, keeperA, keeperB].forEach(p => {
    ctx.beginPath();
    ctx.arc(p.x, p.y, playerSize/2, 0, Math.PI*2);
    ctx.fillStyle = p.color;
    ctx.fill();
  });
}

function drawBall() {
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ballSize, 0, Math.PI*2);
  ctx.fillStyle = "white";
  ctx.fill();
}

function gameLoop() {
  movePlayers();
  moveBall();
  drawField();
  drawPlayers();
  drawBall();
  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
